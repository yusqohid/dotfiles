(()=>{var e={250:e=>{function t(e){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}t.keys=()=>[],t.resolve=t,t.id=250,e.exports=t},354:e=>{function t(e){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}t.keys=()=>[],t.resolve=t,t.id=354,e.exports=t}},t={};function n(o){var r=t[o];if(void 0!==r)return r.exports;var s=t[o]={exports:{}};return e[o](s,s.exports,n),s.exports}n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},n.d=(e,t)=>{for(var o in t)n.o(t,o)&&!n.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:t[o]})},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var o={};(()=>{"use strict";n.r(o);require("core-js/modules/es.regexp.to-string.js"),require("core-js/modules/es.promise.js"),require("core-js/modules/es.string.ends-with.js"),require("core-js/modules/es.array.iterator.js"),require("core-js/modules/web.dom-collections.iterator.js"),require("core-js/modules/es.array.includes.js"),require("core-js/modules/es.string.includes.js"),require("core-js/modules/es.array.reduce.js");const e=require("os");function t(t){return t.reduce(((t,n)=>{const o="win32"===(0,e.platform)()?n.path:`file://${n.path}`;return t[0].push({if:{properties:{builder:{const:n.name}},required:["builder"]},then:{properties:{options:{$ref:o},configurations:{additionalProperties:{$ref:o,required:[]}}}}}),t[1].push({if:{properties:{executor:{const:n.name}},required:["executor"]},then:{properties:{options:{$ref:o},configurations:{additionalProperties:{$ref:o,required:[]}}}}}),t}),[[],[]])}require("core-js/modules/es.object.assign.js"),require("core-js/modules/es.array.sort.js"),require("core-js/modules/es.object.from-entries.js"),require("core-js/modules/es.regexp.exec.js"),require("core-js/modules/es.string.replace.js"),require("core-js/modules/es.regexp.constructor.js");function r(e){const t=Object.entries(e.projects||{}).sort(((e,t)=>e[0].localeCompare(t[0])));return e.projects=Object.fromEntries(t),e}function s(e,t){return t in e}function i(e,t){if(t instanceof Error){const n=t;return`${e}: ${n.message}\n${n.stack}`}return"string"==typeof t?`${e}: ${t}`:t?`${e}: ${t.toString()}`:e}const a=require("path");require("core-js/modules/es.string.starts-with.js");const c=require("fs/promises");async function u(e){try{return(await(0,c.stat)(e)).isDirectory()}catch(t){return!1}}const p=require("@yarnpkg/fslib"),l=require("@yarnpkg/libzip"),f=require("jsonc-parser"),d=new p.ZipOpenFS({libzip:l.getLibzipSync}),g=new p.PosixFS(d),m={};function y(e,t=""){const n=a.join(t,e);return delete m[n]}async function h(e,t=""){if(!e)return{path:"",json:{}};let n=a.join(t,e);n.startsWith("file:\\")&&(n=n.replace("file:\\",""));try{const e=await g.statPromise(n);var o;if(m[n]||e.isFile())return m[o=n]||(m[o]=await async function(e){const t=await g.readFilePromise(e,"utf8");try{return JSON.parse(t)}catch(n){const e=[],o=(0,f.parse)(t,e);if(e.length>0)for(const{error:t,offset:r}of e);return o}}(n)),{path:n,json:m[n]}}catch(r){}return{path:n,json:{}}}async function j(e){const{json:t}=await h((0,a.join)(e,"package.json"));return{packagePath:e,packageName:t.name,packageJson:t}}async function w(e){try{return(await(0,c.stat)(e)).isFile()}catch(t){return!1}}let v;async function b(e){const t=[".cjs",".js"];for(const o of t)try{const t=`.pnp${o}`,n=(0,a.join)(e,t);if(await w(n))return n}catch(n){return}}async function x(e){const t=await b(e);if(t){if(!v){const e=n(354)(t);e.setup(),v=e}return v}}async function k(e){try{return!!(await b(e))}catch(t){return!1}}async function O(e,t){try{var n;const r=await x(e);if(!r)return;let s=null!=(n=r.resolveToUnqualified(t,e+"/"))?n:"";var o;if(s.includes("__virtual__"))s=null!=(o=null==r.resolveVirtual?void 0:r.resolveVirtual(s))?o:"";return s}catch(r){return}}async function N(e,t,n){const o=[];return o.push(...await async function(e,t,n){if(!n)return[];if(t.major<13)return[];const o=Object.values(n).map((t=>`${e}/${t.root}/package.json`)),r=[];for(const i of o)try{(await(0,c.stat)(i)).isFile()&&r.push(i.replace("/package.json",""))}catch(s){}return r}(e,t,n)),await k(e)&&o.push(...await async function(e){const t=await x(e);if(!t)return[];t.resolveRequest;const n=[];for(const r of t.getDependencyTreeRoots()){const s=t.getPackageInformation(r);if(null!=s&&s.packageDependencies)for(const[t,r]of null!=(o=null==s?void 0:s.packageDependencies)?o:{}){var o;if(null===r)continue;if(!Array.isArray(r)&&r.startsWith("workspace:"))continue;const s=await O(e,t);s&&n.push(s)}}return n}(e)),o.push(...await async function(e){const t=(0,a.join)(e,"node_modules"),n=(0,a.join)(e,".nx","installation","node_modules");let o=t;const r=[];try{if(!(await(0,c.stat)(t)).isDirectory())return r}catch(i){try{if(!(await(0,c.stat)(n)).isDirectory())return r;o=n}catch(u){return r}}const s=await(0,c.readdir)(o);for(const p of s)p.startsWith(".")||(await(0,c.stat)((0,a.join)(o,p))).isDirectory()&&(p.startsWith("@")?(await(0,c.readdir)((0,a.join)(o,p))).forEach((e=>{r.push(`${o}/${p}/${e}`)})):r.push(`${o}/${p}`));return r}(e)),o}async function P(e,t){if(t.startsWith("."))return(0,a.join)(e,t);if(await k(e))return O(e,t);const n=(0,a.join)(e,"node_modules",t),o=(0,a.join)(e,".nx","installation","node_modules",t);try{return await u(n)?n:await u(o)?o:void 0}catch(r){return}}async function q(e,t){const n=e=>(0,a.join)(e,t),o=await P(e,"nx");if(o){const e=n(o);if(await w(e))return e}const r=await P(e,"@nrwl/workspace");if(r){const e=n(r);if(await w(e))return e}}const T=require("semver");const R=require("nx/src/devkit-exports");const $=require("vscode-json-languageservice"),C="x-completion-type",D="x-completion-glob";let S;function E(e){return s(e,C)}function A(e){return s(e,D)}!function(e){e.file="file",e.directory="directory",e.projectTarget="projectTarget",e.projects="projects",e.targets="targets",e.targetsWithDeps="targetsWithDeps",e.tags="tags",e.inputName="inputName",e.inputNameWithDeps="inputNameWithDeps"}(S||(S={}));const _={type:"array",items:{type:"string","x-completion-type":S.projects}},I={type:"array",items:{type:"string","x-completion-type":S.directory}},U=e=>[{type:"string","x-completion-type":S.inputNameWithDeps},{type:"object",properties:{input:{type:"string","x-completion-type":S.inputName},projects:M(e)}},{type:"object",properties:{fileset:{type:"string"}}},{type:"object",properties:{runtime:{type:"string"}}},{type:"object",properties:{env:{type:"string"}}}],W=e=>({type:"object",additionalProperties:{oneOf:U(e)}}),F={type:"array",items:{type:"string","x-completion-type":S.tags}},M=e=>e.major<16?{type:"string",enum:["self","dependencies"]}:{oneOf:[{type:"string","x-completion-type":S.projects},{type:"array",items:{type:"string","x-completion-type":S.projects}}]},L=(e,t)=>({additionalProperties:Object.assign({type:"object",properties:Object.assign({outputs:I},t&&{executor:{type:"string"}},t&&{configurations:{additionalProperties:{type:"object"}}},{dependsOn:{type:"array",items:{oneOf:[{type:"string","x-completion-type":S.targetsWithDeps},{type:"object",properties:{projects:M(e),target:{type:"string","x-completion-type":S.targets},params:{type:"string",enum:["ignore","forward"]}}}]}},inputs:{type:"array",items:{oneOf:U(e)}}})},t&&{allOf:t})});function J(e,n={},o){const[,r]=t(e),s=function(e,t,n){var o;const r=null!=(o=L(n,e).additionalProperties)?o:{},s=Object.keys(t).reduce(((n,o)=>{const s=t[o];let i=r;if(null!=s&&s.executor){const t=e.find((e=>{var t;const n=e.if,o=null==n||null==(t=n.properties)?void 0:t.executor;return(null==o?void 0:o.const)===s.executor}));t&&(i={if:{properties:{executor:{type:"string"}},required:["executor"]},then:r,else:t.then})}return n[o]=i,n}),{});return{type:"object",properties:{sourceRoot:{type:"string","x-completion-type":S.directory},implicitDependencies:_,tags:F,namedInputs:W(n),targets:{type:"object",properties:s,additionalProperties:r}}}}(r,n,o);return s}function K(e){const t=function(e){return{type:"object",properties:{nx:{type:"object",properties:{ignore:{type:"boolean"},namedInputs:W(e),tags:F,implicitDependencies:_,targets:L(e)}}}}}(e);return t}function H(e,n,o){const[,r]=t(e),s=function(e){const t=new Set;for(const o of Object.values(e))for(const e of Object.keys(null!=(n=o.targets)?n:{})){var n;t.add(e)}return Array.from(t)}(n);return V(r,s,o)}function V(e,t,n){var o;const r=null!=(o=L(n,e).additionalProperties)?o:{};return{type:"object",properties:{tasksRunnerOptions:{type:"object",additionalProperties:{type:"object",properties:{options:{type:"object",properties:{cacheableOperations:{type:"array",items:{type:"string","x-completion-type":S.targets}}}}}}},targetDefaults:{type:"object",properties:t.reduce(((e,t)=>(e[t]=Object.assign({type:"object"},r),e)),{})},targetDependencyConfig:{type:"array",items:{oneOf:[{type:"string","x-completion-type":S.targetsWithDeps},{type:"object",properties:{target:{type:"string",description:"The name of the target.","x-completion-type":S.targets}}}]}}}}}function G(e){return"property"===(null==e?void 0:e.type)}function z(e){return"object"===(null==e?void 0:e.type)}function B(e){return"string"===(null==e?void 0:e.type)}function X(e){return"array"===(null==e?void 0:e.type)}const Z=new Map;function Q(e){const t=e.parent;if(G(t)&&B(t.keyNode)){const e=t.keyNode.value.toLowerCase();return Z.get(e)}}function Y(e){const t=e.parent;if(G(t)&&B(t.keyNode)){const e=t.keyNode.value.toLowerCase();return Z.has(e)}return!1}Z.set("jestconfig",{glob:"jest.config.@(js|ts)",completionType:S.file}),Z.set("index",{glob:"*.html",completionType:S.file}),Z.set("polyfills",{glob:"*.ts",completionType:S.file}),Z.set("main",{glob:"*.ts",completionType:S.file}),Z.set("tsconfig",{glob:"tsconfig.*.json",completionType:S.file}),Z.set("outputpath",{completionType:S.directory}),Z.set("browsertarget",{completionType:S.projectTarget}),Z.set("servertarget",{completionType:S.projectTarget}),Z.set("buildtarget",{completionType:S.projectTarget}),Z.set("target",{completionType:S.projectTarget}),Z.set("devservertarget",{completionType:S.projectTarget});const ee=require("rxjs");require("core-js/modules/es.string.match.js");let te;const ne={log(e,...t){null==te||te(`[Nxls] - ${new Date(Date.now()).toISOString()} - ${e}\n`,...t)}};async function oe(e,t){const n=await q(e,(0,a.join)("src","utils","output.js"));if(n)return ie(n,t)}async function re(e,t){let n=await q(e,(0,a.join)("src","project-graph","project-graph.js"));return n||(n=await q(e,(0,a.join)("src","core","project-graph","project-graph.js"))),ie(n,t)}async function se(e,t){let n=await q(e,(0,a.join)("src","project-graph","file-utils.js"));return n||(n=await q(e,(0,a.join)("src","core","file-utils.js"))),ie(n,t)}async function ie(t,o){if(!t)throw null==o||o.log(`Unable to load the ${t} dependency from the workspace. Please ensure that the proper dependencies are installed locally.`),"local Nx dependency not found";"win32"===(0,e.platform)()&&(t=t.replace(/\\/g,"/"));const r=n(250)(t);return null==o||o.log(`Using local Nx package at ${t}`),r}const ae=require("perf_hooks");let ce,ue=null;async function pe(e,t,n){const o=ae.performance.now();if(n.log("Retrieving workspace configuration"),t.major<12)return ne.log("Major version is less than 12"),le(e);try{process.env.CI=!1,process.env.NX_PROJECT_GLOB_CACHE=!1,process.env.NX_WORKSPACE_ROOT_PATH=e;const[i,a,c]=await Promise.all([se(e,n),re(e,n),oe(e,n)]);let u;try{u=i.readWorkspaceConfig({format:"nx",path:e})}catch(r){n.log("Unable to read workspace config from nx workspace package"),u=(await le(e)).workspaceConfiguration}try{process.exit=function(e){console.warn("process.exit called with code",e)},void 0!==c&&(c.output.error=e=>{}),t.major<13?ue=a.createProjectGraph():(ne.log("createProjectGraphAsync"),ue=await a.createProjectGraphAsync({exitOnError:!1,resetDaemonClient:!0}),ne.log("createProjectGraphAsync successful"))}catch(s){ne.log("Unable to get project graph"),ne.log(s.stack)}u=function(e,t){if(!t)return e;const n=Object.assign({},e,{projects:{}});for(const[c,u]of Object.entries(t.nodes)){const t=e.projects[c];if(t){var o,r;n.projects[c]=Object.assign({},t,{targets:null!=(o=u.data.targets)?o:{},files:null!=(r=u.data.files)?r:[],name:c})}else{var s,i,a;if(c.match(/:/))continue;n.projects[c]={root:u.data.root,targets:null!=(s=u.data.targets)?s:{},name:c,tags:null!=(i=u.data.tags)?i:[],files:null!=(a=u.data.files)?a:[]}}}return n}(u,ue);const p=ae.performance.now();return n.log(`Retrieved workspace configuration in: ${p-o} ms`),{workspaceConfiguration:u}}catch(s){return ne.log(`Unable to get nx workspace configuration: ${s}`),le(e)}}async function le(e){var t;const n=(await h("workspace.json",e)).json,o=(await h("nx.json",e)).json;return{workspaceConfiguration:Object.assign({},n,o,{projects:Object.assign({},null!=(t=o.projects)?t:{},n.projects)}),configPath:(0,a.join)(e,"workspace.json")}}let fe=!1;const de=new T.SemVer("0.0.0");async function ge(e){if(!fe){const t=await q(e,"package.json");if(!t)return de;ce=n(250)(t),fe=!0}if(!ce)return de;const t=(0,T.coerce)(ce.version);return t||de}var me;!function(e){e[e.not_started=0]="not_started",e[e.in_progress=1]="in_progress",e[e.cached=2]="cached"}(me||(me={}));let ye=new ee.ReplaySubject,he=me.not_started;async function je(e,t={log(e){console.log(e)}},n){return n&&function(e){he=me.not_started,ye=new ee.ReplaySubject,y("workspace.json",e),y("nx.json",e)}(e),(0,ee.firstValueFrom)((0,ee.iif)((()=>he===me.not_started),(0,ee.of)({}).pipe((0,ee.tap)((()=>{he=me.in_progress})),(0,ee.switchMap)((()=>(0,ee.from)(async function(e,t){try{var n,o;const s=await ge(e),i=await pe(e,s,t),c=await w((0,a.join)(e,"lerna.json"));return{validWorkspaceJson:!0,workspace:r(i.workspaceConfiguration),daemonEnabled:i.daemonEnabled,isLerna:c,isEncapsulatedNx:!!i.workspaceConfiguration.installation,workspaceLayout:{appsDir:null==(n=i.workspaceConfiguration.workspaceLayout)?void 0:n.appsDir,libsDir:null==(o=i.workspaceConfiguration.workspaceLayout)?void 0:o.libsDir},nxVersion:{major:s.major,minor:s.minor,full:s.version},workspacePath:e}}catch(s){return t.log(i("Invalid workspace",s)),{validWorkspaceJson:!1,workspace:{npmScope:"@nx-console",projects:{},version:2},workspacePath:e,isEncapsulatedNx:!1,nxVersion:{major:0,minor:0,full:"0.0.0"},isLerna:!1,workspaceLayout:{appsDir:"apps",libsDir:"libs"}}}}(e,t)))),(0,ee.tap)((e=>{ye.next(e),he=me.cached}))),ye))}function we(e,t,n,o,r,s){return{label:e=`"${e}"`,documentation:s,kind:r,insertText:e,insertTextFormat:2,textEdit:{newText:e,range:{start:o.positionAt(n.offset),end:o.positionAt(n.offset+n.length)}},detail:t}}async function ve(e,t,n,o=!1){if(!e)return[];const r=[],{workspace:s}=await je(e);for(const a of Object.keys(null!=(i=s.namedInputs)?i:{})){var i;o&&r.push(we(`^${a}`,"",t,n,$.CompletionItemKind.Property,`Base "${a}" on this project's dependencies`)),r.push(we(a,"",t,n,$.CompletionItemKind.Property))}return r}function be(e){if(z(e))for(const n of e.children){var t;if(G(n))if(("root"===n.keyNode.value||"sourceRoot"===n.keyNode.value)&&B(n.valueNode))return null==(t=n.valueNode)?void 0:t.value}return e.parent?be(e.parent):""}const xe=require("fast-glob");var ke=n.n(xe);async function Oe(e,t,n,o){const r=[];if(!e)return r;const{supportsInterpolation:s,glob:i,searchType:a}=Object.assign({supportsInterpolation:!1},o);if(!B(t))return r;const c=be(t),u=await ke()([e+"/**/"+i],{ignore:["**/node_modules/**"],dot:!0,onlyFiles:"file"===a,onlyDirectories:"directory"===a,objectMode:!0}),p="directory"===a?$.CompletionItemKind.Folder:$.CompletionItemKind.File;for(const l of u){if(s&&l.path.startsWith(e+"/"+c)){const o="{projectRoot}"+l.path.replace(e+"/"+c,"");r.push(we(o,l.path,t,n,p))}if(l.path.startsWith(e)){const o=l.path.replace(e+"/","");if(s){const o="{workspaceRoot}"+l.path.replace(e,"");r.push(we(o,l.path,t,n,p))}else r.push(we(o,l.path,t,n,p))}}return r}async function Ne(e,t,n){if(!e)return[];const o=[],{workspace:r}=await je(e),s=new Set;for(const c of Object.values(r.projects))for(const e of null!=(i=c.tags)?i:[]){var i;s.add(e)}const a=function(e){const t=e.parent;if(!X(t))return new Set;return new Set(t.items.map((e=>e.value)))}(t);for(const c of s)a.has(c)||o.push(we(c,"",t,n,$.CompletionItemKind.Constant));return o}async function Pe(e,t,n,o=!1){if(!e)return[];const r=[],{workspace:s}=await je(e),i=new Set;for(const u of Object.values(s.projects))for(const e of Object.keys(null!=(a=u.targets)?a:{})){var a;i.add(e)}const c=function(e){const t=e.parent;if(!X(t))return new Set;return new Set(t.items.map((e=>e.value)))}(t);for(const u of i)if(!c.has(u)){if(o){const e=`^${u}`;if(c.has(e))continue;r.push(we(e,"",t,n,$.CompletionItemKind.Field,`Run all dependencies that have "${u}" as a target before this one`))}r.push(we(u,"",t,n,$.CompletionItemKind.Field))}return r}async function qe(e,t,n,o,r,s){if(!e)return[];const i=o.offsetAt(s),a=n.getNodeFromOffset(i);if(!a)return[];const c=function(e,t,n,o){return async(t,r)=>{const s=!1;switch(t){case S.file:return Oe(e,n,o,{glob:null!=r?r:"*.*",searchType:"file",supportsInterpolation:s});case S.directory:return Oe(e,n,o,{glob:null!=r?r:"*",searchType:"directory",supportsInterpolation:s});case S.projectTarget:return async function(e,t,n){if(!e)return[];const{workspace:o}=await je(e),r=[],s=$.CompletionItemKind.Field;for(const[c,u]of Object.entries(o.projects))for(const[e,o]of Object.entries(null!=(i=u.targets)?i:{})){var i;const u=`${c}:${e}`;r.push(we(u,"",t,n,s));for(const e of Object.keys(null!=(a=o.configurations)?a:{})){var a;const o=`${u}:${e}`;r.push(we(o,"",t,n,s))}}return r}(e,n,o);case S.projects:return async function(e,t,n){if(!e)return[];const{workspace:o}=await je(e),r=[];for(const s of Object.keys(o.projects))r.push(we(s,"",t,n,$.CompletionItemKind.Struct),we(`!${s}`,"",t,n,$.CompletionItemKind.Struct,`Exclude "${s}" from this project's dependencies`));return r}(e,n,o);case S.tags:return Ne(e,n,o);case S.targets:return Pe(e,n,o);case S.targetsWithDeps:return Pe(e,n,o,!0);case S.inputName:return ve(e,n,o);case S.inputNameWithDeps:return ve(e,n,o,!0);default:return[]}}}(e,0,a,o);let u=[];for(const{schema:l,node:f}of r)if(f==a&&E(l)){const e=l[C];if(A(l)){u=await c(e,l[D]);break}u=await c(e);break}const p=Q(a);if(p&&0===u.length&&(u=await c(p.completionType,p.glob)),X(a.parent)){const e=a.parent.children.map((e=>JSON.stringify(e.value)));u=u.filter((t=>!e.includes(t.label)))}return u}function Te(e,t){const n=e.positionAt(t.offset),o=e.positionAt(t.offset+t.length);return $.Range.create(n,o)}const Re=require("@nx/devkit/src/executors/parse-target-string");const $e=require("vscode-languageserver-textdocument");let Ce;function De(){return Ce||ne.log("Language service not configured"),Ce}let Se={};let Ee,Ae=0;function _e(){return{retrieve(e,t=!0){const n=e.version,o=e.languageId,r=Se[e.uri];if(r&&r.version===n&&r.languageId===o)return r.cTime=Date.now(),{jsonAst:r.languageModel,document:r.document};t&&(e=$e.TextDocument.create(e.uri,e.languageId,e.version,e.getText().replace(/"\$schema":\s".+",/,"")));const s=(e=>{var t;return null==(t=De())?void 0:t.parseJSONDocument(e)})(e);if(!s)return{jsonAst:{root:void 0,getNodeFromOffset(){}},document:e};if(Se[e.uri]={languageModel:s,version:n,languageId:o,document:e,cTime:Date.now()},r||Ae++,10===Ae){let e=Number.MAX_VALUE,t=null;for(const n in Se){const o=Se[n];o.cTime<e&&(t=n,e=o.cTime)}t&&(delete Se[t],Ae--)}return{jsonAst:s,document:e}},onDocumentRemoved(e){const t=e.uri;Se[t]&&(delete Se[t],Ae--)},dispose(){void 0!==Ee&&(clearInterval(Ee),Ee=void 0,Se={},Ae=0)}}}function Ie(e,t){if(G(e)&&e.valueNode&&(e=e.valueNode),z(e))for(const n of e.properties){if(n.keyNode.value===t)return n;if(z(n.valueNode)){const e=Ie(n.valueNode,t);if(e)return e}}}Ee=setInterval((()=>{const e=Date.now()-6e4,t=Object.keys(Se);for(const n of t){Se[n].cTime<e&&(delete Se[n],Ae--)}}),6e4);const Ue=require("vscode-uri"),We=new Map;async function Fe(e,t){if(!B(t))return;const n=t.value;let o,r,s;try{const e=(0,Re.parseTargetString)(n);o=e.project,r=e.target,s=e.configuration}catch(j){return}const{workspace:i}=await je(e,ne),c=i.projects[o];if(!c)return void ne.log(`Could not find project ${o}`);const u=(0,a.join)(e,c.root),p=(0,a.join)(u,"project.json");if(!(await w(p)))return void ne.log(`Could not find target project: ${p}`);const l=await async function(e){try{return g.readFilePromise(e,"utf8")}catch(t){return""}}(p);let f=0;var d;We.has(p)?(f=null!=(d=We.get(p))?d:0,We.set(p,f+1)):We.set(p,f);const{document:m,jsonAst:y}=_e().retrieve($.TextDocument.create(p,"json",f,l),!1),h=function(e,t,n,o){if(!t.root)return;const r=Ie(t.root,"targets");if(!r)return;const s=Ie(r,n);if(!s)return;if(!o)return Te(e,s);{const t=Ie(s,o);if(t)return Te(e,t)}}(m,y,r,s);return h?Ue.URI.from({scheme:"file",path:p,fragment:`${h.start.line+1}`}).toString():void 0}async function Me(e,t,n){var o;const r=await(null==(o=De())?void 0:o.doHover(n,e.position,t));if(!r)return;const s=n.offsetAt(e.position),i=t.getNodeFromOffset(s);return i?(function(e){return B(e)&&G(e.parent)&&"executor"===e.parent.keyNode.value&&(RegExp(/@nx|@nrwl\/\w+:\w+/).test(e.value)||RegExp(/nx:\w+/).test(e.value))}(i)&&(r.contents={kind:"markdown",value:`[View executor documentation on nx.dev](${Le(i.value)})`}),r):r}function Le(e){const[t,n]=e.replace(/@nx|@nrwl/,"").split(":");return`https://nx.dev/packages/${t}/executors/${n}`}const Je=require("vscode-languageserver/node"),Ke=new Je.NotificationType("nx/changeWorkspace"),He=new Je.NotificationType("nx/refreshWorkspace"),Ve=new Je.RequestType("nx/workspace"),Ge=new Je.RequestType("nx/generators"),ze=new Je.RequestType("nx/generatorOptions"),Be=new Je.RequestType("nx/projectByPath"),Xe=new Je.RequestType("nx/generatorContextFromPath"),Ze=new Je.RequestType("nx/version"),Qe=new Je.RequestType("nx/projectGraphOutput"),Ye=new Je.RequestType("nx/createProjectGraph");const et=require("request-light"),tt=require("fs");function nt(e=["https","http","file"]){const t={};for(const n of e)"file"===n?t[n]={getContent:(e,t)=>new Promise(((n,o)=>{const r=Ue.URI.parse(e);tt.readFile(r.fsPath,t,((e,t)=>{if(e)return o(e);n(t.toString())}))}))}:"http"!==n&&"https"!==n||(t[n]={getContent:(e,t)=>(0,et.xhr)({url:e,followRedirects:5,headers:{"Accept-Encoding":"gzip, deflate"}}).then((e=>e.responseText),(e=>Promise.reject(e.responseText||(0,et.getErrorStatusDescription)(e.status)||e.toString())))});return e=>{const n=e.substr(0,e.indexOf(":")),o=t[n];return o?o.getContent(e):Promise.reject("Unable to retrieve schema")}}const ot=require("@parcel/watcher");async function rt(t,n){const o=await ot.subscribe(t,((e,t)=>{e?ne.log("Error watching files: "+e.toString()):t.some((e=>e.path.endsWith("project.json")||e.path.endsWith("package.json")||e.path.endsWith("nx.json")||e.path.endsWith("workspace.json")))&&(ne.log("Project configuration changed"),function(e,t){let n;return()=>{clearTimeout(n),n=setTimeout((()=>{e()}),t)}}(n,200)())}),function(t){const n={ignore:[(0,a.join)(t,"node_modules")]};"win32"===(0,e.platform)()&&(n.backend="windows");return n}(t));return()=>{ne.log("Unregistering file watcher"),o.unsubscribe()}}require("core-js/modules/es.symbol.description.js");function st(e){if(e.indexOf("node_modules")>-1)return[];if(e.indexOf("dist")>-1)return[];const t=[e];try{(0,tt.readdirSync)(e).forEach((n=>{const o=a.join(e,n);try{(0,tt.statSync)(o).isDirectory()?(0,tt.statSync)(o).isDirectory()&&t.push(...st(o)):t.push(o)}catch(r){}}))}catch(n){}return t}let it,at;!function(e){e.Any="any",e.Array="array",e.Boolean="boolean",e.Number="number",e.String="string"}(it||(it={})),function(e){e.Application="application",e.Library="library",e.Other="other"}(at||(at={}));let ct,ut;!function(e){e.TaskExecutionFormInit="output-init",e.RunCommand="run-command"}(ct||(ct={}));!function(e){e.SetTaskExecutionSchema="generator",e.SetGlobalConfiguration="config",e.SetStyles="style"}(ut||(ut={}));function pt(e){var t;return"project"===e.name||"projectName"===e.name||"projectName"===(null==(t=e.$default)?void 0:t.$source)||"projects"===e["x-dropdown"]}async function lt(e,t){const n=(o=e,Object.keys(o.properties||{}).reduce(((e,t)=>{const n=o.properties[t],r=n.$default,s="argv"===(null==r?void 0:r.$source)?r.index:void 0,i="number"==typeof s?s:void 0,a=function(e,t){var n;return!!["path"].includes(e)||("hidden"in t?!t.hidden:null==(n=t.visible)||n)}(t,n);return a?(e.push(Object.assign({name:t,originalName:t,positional:i},n)),e):e}),[]));var o;const r=new Set(e.required||[]),s=n.map((e=>{var n;const o=e["x-prompt"],s=null==t?void 0:t[null!=(n=e.originalName)?n:e.name],i=e.$default,a=Object.assign({},e,{isRequired:gt(r,e,o,i),aliases:e.alias?[e.alias]:[]},void 0!==s&&{default:s},i&&{$default:i},e.enum&&{items:e.enum.map((e=>e.toString()))},function(e){return e.items&&{items:e.items.enum||e.items.length&&e.items}}(e));if(o&&(a.tooltip=mt(o)?o.message:o,a.itemTooltips=function(e){const t={};e&&mt(e)&&(e.items||[]).forEach((e=>{yt(e)&&e.label&&(t[e.value]=e.label)}));return t}(o),mt(o)&&!a.items)){const e=(o.items||[]).map((e=>yt(e)?e.value:e));e.length>0&&(a.items=e)}return a})),i=s.some((e=>void 0!==e["x-priority"]))?ft:dt;return s.sort(i)}function ft(e,t){function n(e){return e.isRequired?0:"important"===e["x-priority"]?1:e["x-deprecated"]?4:"internal"===e["x-priority"]?3:2}const o=n(e),r=n(t);return o===r?"number"==typeof e.positional&&"number"==typeof t.positional?e.positional-t.positional:"number"==typeof e.positional?-1:"number"==typeof t.positional?1:e.name.localeCompare(t.name):o-r}function dt(e,t){const n=["name","project","module","watch","style","directory","port"],o=new Set(n);return"number"==typeof e.positional&&"number"==typeof t.positional?e.positional-t.positional:"number"==typeof e.positional?-1:"number"==typeof t.positional?1:e.isRequired?t.isRequired?e.name.localeCompare(t.name):-1:t.isRequired?1:o.has(e.name)?o.has(t.name)?n.indexOf(e.name)-n.indexOf(t.name):-1:o.has(t.name)?1:e.name.localeCompare(t.name)}function gt(e,t,n,o){return e.has(t.name)||!!n&&!t.default&&!o&&"boolean"!==t.type}function mt(e){return void 0!==e.message}function yt(e){return void 0!==e.value||void 0!==e.label}require("core-js/modules/es.array.flat.js"),require("core-js/modules/es.array.unscopables.flat.js");async function ht(e,t){null!=t&&t.clearPackageJsonCache&&y("package.json",e);const{workspace:{projects:n},nxVersion:o}=await je(e),r=await N(e,o,n),s=await Promise.all(r.map((async e=>await j(e)))),i=(await Promise.all(s.map((n=>jt(e,n,t))))).flat(),a=new Map;for(const c of i)c&&(a.has(xt(c.name,c.type))||a.set(xt(c.name,c.type),c));return Array.from(a.values())}async function jt(e,{packagePath:t,packageName:n,packageJson:o},r){try{const[s,i]=await Promise.all([h(o.executors||o.builders,t),h(o.generators||o.schematics,t)]);return wt(e,n,t,s,i,r)}catch(s){return null}}async function wt(t,n,o,r,s,i){const c=new Map,u=(t,r,s,i)=>{let c=(0,a.resolve)(o,(0,a.dirname)(i),r.schema);return"win32"===(0,e.platform)()&&(c=`file:///${c.replace(/\\/g,"/")}`),{name:`${n}:${t}`,type:s,path:c}},p=Object.assign({},r.json.executors,r.json.builders);for(const[e,a]of Object.entries(p)){if(!bt(e,a,i.includeHidden,i.includeNgAdd))continue;const t=u(e,a,"executor",r.path);c.has(xt(t.name,"executor"))||c.set(xt(t.name,"executor"),t)}const l=Object.assign({},s.json.generators,s.json.schematics);for(const[e,a]of Object.entries(l))if(bt(e,a,i.includeHidden,i.includeNgAdd))try{const t=u(e,a,"generator",s.path);if(t.data=vt(n,e,a),c.has(xt(t.name,"generator")))continue;c.set(xt(t.name,"generator"),t)}catch(f){}if(s.json.extends&&Array.isArray(s.json.extends)){const e=s.json.extends,n=(await Promise.all(e.filter((e=>"@nx/workspace"!==e&&"@nrwl/workspace"!==e)).map((async e=>{const n=await P(t,e);return n?jt(t,await j(n),i):null})))).flat().filter((e=>Boolean(e)));for(const t of n)c.has(t.name)||c.set(t.name,t)}return Array.from(c.values())}function vt(e,t,n){try{var o;let r;switch(n["x-type"]){case"application":r=at.Application;break;case"library":r=at.Library;break;default:r=at.Other}return{name:t,collection:e,description:n.description||"",aliases:null!=(o=n.aliases)?o:[],type:r}}catch(r){console.error(r),console.error(`Invalid package.json for schematic ${e}:${t}`)}}function bt(e,t,n=!1,o=!1){return(!t.hidden||n)&&!t.private&&!t.extends&&!t["x-deprecated"]&&("ng-add"!==e||o)}function xt(e,t){return`${e}-${t}`}async function kt(e,t,n){const o=(0,a.join)("tools",t);if(await u((0,a.join)(e,o))){const r=await async function(e,t,n,o){const r=(0,a.join)(e,t),s="workspace-"+("generators"===n?"generator":"schematic"),i=(0,a.join)(r,"collection.json");if(await w(i)){const t=await h(`${r}/collection.json`);return wt(e,s,i,{path:i,json:{}},t.json,o)}return await Promise.all(st(r).filter((e=>"schema.json"===(0,a.basename)(e))).map((async e=>{var t,n;const o=await h(e,""),r=o.json.id||o.json.$id,i=null!=(t=o.json["x-type"])?t:at.Other;return{name:s,type:"generator",path:e,data:{name:r,collection:s,options:await lt(o.json),description:null!=(n=o.json.description)?n:"",type:i}}})))}(e,o,t,n);return r}return Promise.resolve([])}async function Ot(e,t,n,o){const r=await h(o),s=await async function(e){const{workspace:t}=await je(e);let n=t.generators;if(!n)try{n=t.generators||{}}catch(r){n={}}const o=Object.keys(n).reduce(((e,t)=>{if(t.includes(":")){var o;const[r,s]=t.split(":");e[r]||(e[r]={}),e[r][s]=null==(o=n)?void 0:o[t]}else{var r,s;const o=t;e[o]||(e[o]={}),Object.keys(null!=(r=null==(s=n)?void 0:s[o])?r:{}).forEach((t=>{var r;e[o][t]=null==(r=n)?void 0:r[o][t]}))}return e}),{});return o}(e),i=s&&s[t]&&s[t][n];return await lt(r.json,i)}async function Nt(e,t){if(!e)return null;const{workspace:n}=await je(t),o=(0,a.relative)(t,e),r=await u(e),s=Object.entries(n.projects);let i=null;for(const[c,u]of s){const n=qt(u.root,o),s=u.sourceRoot?(0,a.relative)(t,u.sourceRoot):void 0,p=s&&qt(s,o);if(u.files?(r&&(n||p)||!r&&u.files.some((({file:e})=>e===o)))&&(i=u):i=Pt([c,u],t,e),i)break}return i}function Pt(e,t,n){var o;if(!e)return null;let r,s;const[,i]=e,c=(0,a.join)(t,i.root||i.sourceRoot||"");c===n&&(r=e);const u=(0,a.relative)(c,n);return!u||u.startsWith("..")||(0,a.isAbsolute)(u)||(s=e),(e=null!=(o=r)?o:s)?Object.assign({name:e[0]},e[1]):null}function qt(e,t){const n=e.endsWith(a.sep)?e:e+a.sep;return(t.endsWith(a.sep)?t:t+a.sep).startsWith(n)}function Tt(e){const t=(0,a.join)(R.cacheDir,"nx-console-project-graph"),n=`${t}/project-graph.html`;return{directory:t,relativePath:`./${(0,a.normalize)((0,a.relative)(e,n))}`,fullPath:n}}const Rt=require("child_process");async function $t(t,n={log(e){console.log(e)}}){const{isEncapsulatedNx:o}=await je(t),r=Tt(t);return new Promise(((s,i)=>{const a=function(t){let n=t.displayCommand;if(t.encapsulatedNx)n="win32"==(0,e.platform)()?n.replace(/^nx/,"./nx.bat"):n.replace(/^nx/,"./nx");else if(t.useNpx)n=`npx ${n}`;else{const e=(0,R.detectPackageManager)(t.cwd);n=`${(0,R.getPackageManagerCommand)(e).exec} ${n}`}return n}({cwd:t,displayCommand:"nx dep-graph --file "+r.relativePath,encapsulatedNx:o,useNpx:!0});n.log(`Generating graph with command: \`${a}\``);try{(0,Rt.execSync)(a,{cwd:t,windowsHide:!0,stdio:"ignore"}),s(void 0)}catch(c){i("Unable to create project graph: "+(c.output[1].toString()||c.toString()))}}))}let Ct,Dt;process.on("unhandledRejection",(e=>{At.console.error(i("Unhandled exception",e))})),process.on("uncaughtException",(e=>{At.console.error(i("Unhandled exception",e))}));let St=()=>{};const Et={resolveRelativePath:(e,t)=>{const n=t.substring(0,t.lastIndexOf("/")+1);return Ue.Utils.resolvePath(Ue.URI.parse(n),e).toString()}},At=(0,Je.createConnection)(Je.ProposedFeatures.all),_t=new Je.TextDocuments($.TextDocument);_t.listen(At),At.onInitialize((async e=>{var t;!function(e){if(te)throw"Can't set logger twice";te=e.console.log.bind(e.console)}(At);const{workspacePath:n}=null!=(t=e.initializationOptions)?t:{};try{var o,r,s;if(Ct=n||(null==(o=e.workspaceFolders)||null==(r=o[0])?void 0:r.uri)||e.rootPath||Ue.URI.parse(null!=(s=e.rootUri)?s:"").fsPath,!Ct)throw"Unable to determine workspace path";Dt=e.capabilities,Wt(Ct,Dt),St=await rt(Ct,(async()=>{await Ut(Ct),await At.sendNotification(He.method)}))}catch(i){ne.log("Unable to get Nx info: "+i.toString())}return{capabilities:{textDocumentSync:Je.TextDocumentSyncKind.Incremental,completionProvider:{resolveProvider:!1,triggerCharacters:['"',":"]},hoverProvider:!0,documentLinkProvider:{resolveProvider:!1,workDoneProgress:!1},workspace:{fileOperations:{didCreate:{filters:[{pattern:{glob:"**/project.json",matches:Je.FileOperationPatternKind.file}}]},didDelete:{filters:[{pattern:{glob:"**/project.json",matches:Je.FileOperationPatternKind.file}}]}}}}}})),At.onCompletion((async e=>{var t,n,o;if(!Ct)return new Je.ResponseError(1e3,"Unable to get Nx info: no workspace path");const r=_t.get(e.textDocument.uri);if(!r)return null;const{jsonAst:s,document:i}=Ft(r),a=null!=(t=await(null==(n=De())?void 0:n.doComplete(i,e.position,s)))?t:$.CompletionList.create([]),c=await(null==(o=De())?void 0:o.getMatchingSchemas(i,s));if(!c)return a;const{nxVersion:u}=await je(Ct,ne),p=await qe(Ct,0,s,i,c,e.position);var l,f;return l=a.items,f=p,Array.prototype.push.apply(l,f),a})),At.onHover((async e=>{const t=_t.get(e.textDocument.uri);if(!t)return null;const{jsonAst:n,document:o}=Ft(t);return await Me(e,n,o)})),At.onDocumentLinks((async e=>{var t;const n=_t.get(e.textDocument.uri);if(!n)return null;const{jsonAst:o,document:r}=Ft(n),s=await(null==(t=De())?void 0:t.getMatchingSchemas(r,o));return s?async function(e,t,n,o){if(!e)return[];const r=[];if(!t.root)return[];const s=be(t.root),i=(0,a.join)(e,s);for(const{schema:u,node:p}of o){let t;if(E(u))t=u[C];else if(Y(p)){var c;t=null==(c=Q(p))?void 0:c.completionType}if(!t)continue;if("directory"===t)continue;const o=Te(n,p);switch(t){case"file":{if(!B(p))continue;const t=(0,a.join)(e,p.value);if(!(await w(t)))continue;p.value===s?r.push({range:o,target:i}):r.push($.DocumentLink.create(o,t));break}case"projectTarget":{const t=await Fe(e,p);t&&r.push($.DocumentLink.create(o,t));break}}}return r}(Ct,o,r,s):void 0}));const It=_e();async function Ut(e){await je(e,ne,!0),await Wt(e,Dt)}async function Wt(e,n){if(!e)return void ne.log("No workspace path provided");const{workspace:o,nxVersion:r}=await je(e,ne),s=await async function(e,t={includeHidden:!1,clearPackageJsonCache:!1}){return(await ht(e,{clearPackageJsonCache:t.clearPackageJsonCache,includeHidden:t.includeHidden})).filter((e=>"executor"===e.type))}(e),i=function(e){const[n,o]=t(e),r=function(e,t){return{title:"JSON schema for Nx workspaces",id:"https://nx.dev",type:"object",properties:{version:{type:"number",enum:[1,2]}},allOf:[{if:{properties:{version:{const:1}},required:["version"]},then:{properties:{projects:{type:"object",additionalProperties:{type:"object",properties:{architect:{description:"Configures all the targets which define what tasks you can run against the project",additionalProperties:{type:"object",properties:{builder:{description:"The function that Nx will invoke when you run this architect",type:"string"},options:{type:"object"},configurations:{description:"provides extra sets of values that will be merged into the options map",additionalProperties:{type:"object"}}},allOf:e}}}}}}}},{if:{properties:{version:{const:2}},required:["version"]},then:{properties:{projects:{type:"object",additionalProperties:{oneOf:[{type:"string"},{type:"object",properties:{targets:{description:"Configures all the targets which define what tasks you can run against the project",additionalProperties:{type:"object",properties:{executor:{description:"The function that Nx will invoke when you run this target",type:"string"},options:{type:"object"},configurations:{description:"provides extra sets of values that will be merged into the options map",additionalProperties:{type:"object"}}},allOf:t}}}}]}}}}}]}}(n,o);return r}(s),a=J(s,o.targetDefaults,r),c=K(r),u=H(s,o.projects,r);var p,l;p={schemaRequestService:nt(["file"]),workspaceContext:Et,contributions:[],clientCapabilities:n},l={schemas:[{uri:"nx://schemas/workspace",fileMatch:["**/workspace.json"],schema:i},{uri:"nx://schemas/project",fileMatch:["**/project.json"],schema:a},{uri:"nx://schemas/package",fileMatch:["**/package.json"],schema:c},{uri:"nx://schemas/nx",fileMatch:["**/nx.json"],schema:u}]},Ce=(0,$.getLanguageService)(p),Ce.configure(l)}function Ft(e){return It.retrieve(e)}_t.onDidClose((e=>{It.onDocumentRemoved(e.document)})),At.onShutdown((()=>{St(),It.dispose()})),At.onRequest(Ve,(async({reset:e})=>Ct?je(Ct,ne,e):new Je.ResponseError(1e3,"Unable to get Nx info: no workspace path"))),At.onRequest(Ge,(async e=>Ct?async function(e,t={includeHidden:!1,includeNgAdd:!1}){const n=e;let o=(await ht(e,{clearPackageJsonCache:!1,includeHidden:t.includeHidden,includeNgAdd:t.includeNgAdd})).filter((e=>"generator"===e.type));return o=[...o,...await kt(n,"schematics",t),...await kt(n,"generators",t)],o.filter((e=>!!e.data))}(Ct,e.options):new Je.ResponseError(1e3,"Unable to get Nx info: no workspace path"))),At.onRequest(ze,(async e=>Ct?Ot(Ct,e.options.collection,e.options.name,e.options.path):new Je.ResponseError(1e3,"Unable to get Nx info: no workspace path"))),At.onRequest(Be,(async e=>Ct?Nt(e.projectPath,Ct):new Je.ResponseError(1e3,"Unable to get Nx info: no workspace path"))),At.onRequest(Xe,(async e=>Ct?async function(e,t,n){var o;if(!t)return;const r=await Nt(t,n),s=r&&r.name||void 0;let i=t.replace(n,"").replace(/\\/g,"/").replace(/^\//,"");const{workspaceLayout:a}=await je(n),c=a.appsDir,u=a.libsDir;return c&&("application"===(null==e?void 0:e.name)||"app"===(null==e?void 0:e.name)||i.startsWith(c))&&(i=i.replace(c,"").replace(/^\//,"")),u&&("library"===(null==e?void 0:e.name)||"lib"===(null==e?void 0:e.name)||i.startsWith(u))&&(i=i.replace(u,"").replace(/^\//,"")),Object.assign({project:s,projectName:s,path:i},!(s&&null!=e&&null!=(o=e.options)&&o.some(pt))&&{directory:i})}(e.generator,e.path,Ct):new Je.ResponseError(1e3,"Unable to get Nx info: no workspace path"))),At.onRequest(Ze,(async()=>Ct?ge(Ct):new Je.ResponseError(1e3,"Unable to get Nx info: no workspace path"))),At.onRequest(Qe,(async()=>Ct?Tt(Ct):new Je.ResponseError(1e3,"Unable to get Nx info: no workspace path"))),At.onRequest(Ye,(async()=>{if(!Ct)return new Je.ResponseError(1e3,"Unable to get Nx info: no workspace path");try{await $t(Ct,ne)}catch(e){return e}})),At.onNotification(He,(async()=>{if(!Ct)return new Je.ResponseError(1001,"Unable to get Nx info: no workspace path");await Ut(Ct)})),At.onNotification("workspace/didCreateFiles",(async e=>{if(e.files.some((e=>e.uri.endsWith("project.json"))))return Ct?void(await Ut(Ct)):new Je.ResponseError(1001,"Unable to get Nx info: no workspace path")})),At.onNotification("workspace/didDeleteFiles",(async e=>{if(e.files.some((e=>e.uri.endsWith("project.json"))))return Ct?void(await Ut(Ct)):new Je.ResponseError(1001,"Unable to get Nx info: no workspace path")})),At.onNotification(Ke,(async e=>{Ct=e,await Ut(Ct)})),At.listen()})();var r=exports;for(var s in o)r[s]=o[s];o.__esModule&&Object.defineProperty(r,"__esModule",{value:!0})})();
//# sourceMappingURL=main.js.map